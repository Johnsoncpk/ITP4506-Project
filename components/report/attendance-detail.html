<div class="page-content">
    <div class="container-fluid">
        <h2>Attendance Record</h2>
        <hr />
        <div class="row gutters-sm">
            <div class="col-md-12 py-3">
                <div class="row">
                    <div class="col-md-12 py-3">
                        <div class="dropdown">
                            <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
                                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Period
                            </button>
                            <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                <a class="dropdown-item" href="#">Year</a>
                                <a class="dropdown-item" href="#">Month</a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card p-0">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th scope="col">Date</th>
                                <th scope="col">Time</th>
                                <th scope="col">Status</th>
                            </tr>
                        </thead>
                        <tbody id="table"></tbody>
                    </table>
                </div>
            </div>
        </div>
        <hr />
        <footer class="text-center">
            <div class="mb-2">
                <small>
                    Â© 2021 made by -
                    <a target="_blank" rel="noopener noreferrer" href="https://www.ive.edu.hk/ivesite/html/tc/">
                        Ive Jai
                    </a>
                </small>
            </div>
        </footer>
    </div>
</div>

<script>
    $(document).ready(function () {

        let searchParams = new URLSearchParams(window.location.search)
        //alert(searchParams.get('type'));
        var studentId = searchParams.get('studentId');

        $.ajax({
            type: "post",
            url: `http://127.0.0.1/itp4506/Attendance-Online-Server/genReport/searchAttendance.php`,
            data: {
                id: studentId,
            },
            success: function (data, status, xhr) {
                console.log(data);
                var result = "";
                $(data).each(function (index) {
                    result += `
                        <tr>
                        <td>${this.date}</td>
                        <td>${this.time}</td>
                        <td>${this.status}</td>
                        </tr>
                        `;
                });
                $("#table").append(result);
            },
            error: function (jqXhr, textStatus, errorMessage) {
            }
        });

        $(".dropdown-item").click(function () {
            $("#dropdownMenuButton").text($(this).text());
        });

        $("#query").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#table tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1);
            });
        });
    });
</script>